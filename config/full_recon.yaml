description: "Complete reconnaissance pipeline including subdomain discovery, HTTP probing, and vulnerability scanning"
name: full_recon
execution_mode: hybrid
tools:
  - name: subfinder
    description: Subdomain discovery
    type: domain_enum
    command: subfinder
    flags:
      - flag: "-d"
        option: "Domain"
        required: true
      - flag: "-o"
        option: "Output"
        default: "subdomain_subfinder_output.txt"

  - name: findomain
    description: Subdomain enumeration
    type: domain_enum
    command: findomain
    flags:
      - flag: "-t"
        option: "Domain"
        required: true
      - flag: "-u"
        option: "Output"
        default: "subdomain_findomain_output.txt"

  - name: chaos-client
    description: Chaos client for subdomain enumeration
    type: domain_enum
    command: chaos-client
    flags:
      - flag: "-d"
        option: "Domain"
        required: true
      - flag: "-silent"
        is_positional: true
        option: "Silent Mode"
        default: true
      - flag: "-o"
        option: "Output"
        default: "subdomain_chaos_client_output.txt"

  - name: httpxbb
    description: httpx for probing discovered subdomains
    command: httpxbb
    type: recon
    depends_on: ["subfinder", "findomain", "chaos-client"]
    flags:
      - flag: "-l"
        option: "Input"
        default: "httpx_input.txt"
      - flag: "-o"
        option: "Output"
        default: "httpx_output.txt"
      - flag: "-silent"
        description: "Run in silent mode"
        is_boolean: true
      - flag: "-t"
        default: "20"
  
  - name: nmap
    description: Nmap for port scanning live subdomains
    command: nmap
    type: recon
    depends_on: ["subfinder", "findomain", "chaos-client"]
    flags:
      - flag: "-iL"
        option: "Input"
        default: "httpx_input.txt"
      - flag: "-oX"
        option: "Output"
        default: "nmap_output.xml"
      - flag: "-sS"
        description: "TCP SYN scan"
        is_flag: true
      - flag: "-Pn"
        description: "Skip host discovery"
        is_flag: true
      - flag: "-T4"
        description: "Aggressive timing"
        is_flag: true
      - flag: "--top-ports"
        option: "Ports"
        default: "1000"
  - name: ffuf
    description: Fuzzing tool for discovering hidden resources
    command: ffuf
    type: recon
    replace: "{{URL}}"
    replace_from: "httpx_output.txt"
    depends_on: ["httpxbb"]
    flags:
      - flag: "-noninteractive"
        description: "Disable interactive mode to prevent stdin issues"
        default: ""
      - flag: "-u"
        option: "Input"
        default: "{{URL}}/FUZZ"
      - flag: "-w"
        option: "Wordlist"
        default: "/home/alesawe/bbtools/data/manual/raft-small-directories-lowercase.txt"
      - flag: "-mc"
        description: "Match response code"
        default: "200"
      - flag: "-fs"
        description: "filter out 0 response sizes"
        default: "0"
      - flag: "-t"
        default: "10"
      - flag: "-o"
        description: "output flag"
        option: "Output"
        default: "{{URL}}_ffuf_output.json"

  - name: gowitness
    description: Web screenshot
    command: gowitness
    type: fingerprint
    depends_on: ["httpxbb"]
    flags:
      - flag: "scan"
        is_positional: true
      - flag: "file"
        is_positional: true
      - flag: "-f"
        option: "File"
        default: "httpx_output.txt"
        required: true
      - flag: "--screenshot-path"
        option: "ScreenshotPath"
        default: "."
      - flag: "-t"
        option: "Threads"
        default: "2"

  - name: nuclei
    description: Vulnerability scanner using templates
    command: nuclei
    type: vuln
    depends_on: ["httpxbb"]
    flags:
      - flag: "-list"
        option: "List of URLs"
        required: true
        default: "httpx_output.txt"
      - flag: "-jle"
        option: "Output"
        default: "nuclei_output.json"
      - flag: "-s"
        option: "Severity values"
        default: "medium,high,critical"
      - flag: "-pt"
        option: "Protocol types"
        default: "http,dns"
      - flag: "-c"
        option: "Concurrency"
        default: "5"
    posthooks:
      - "NucleiNotifier"
